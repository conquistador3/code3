#include <bits/stdc++.h>

using namespace std;
map < string , int > mp;

int main()
{
ios_base::sync_with_stdio(0);
int n,m,i,j,k,q=1;
string s,ss;

double p;
cin>>n;
while(n!=0)
{
    double dp[n][n];
    for(i=0;i<n;i++)
    {
        cin>>s;

        mp[s]=i;
    }
    cin>>m;
 for(i=0;i<n;i++)
    {
        for(j=0;j<n;j++)
            dp[i][j]=-1;
    }
    for(k=0;k<m;k++)
    {
        cin>>s>>p>>ss;
        dp[mp[s]][mp[ss]]=p;
    }
    for(k=0;k<n;k++)
    {
        for(i=0;i<n;i++)
        {
            for(j=0;j<n;j++)
            {
                if(dp[i][k]!=-1&&dp[k][j]!=-1)
                {
                    dp[i][j]=max(dp[i][j],dp[i][k]*dp[k][j]);
                }
            }
        }
    }
    /*for(i=0;i<n;i++)
    {
        for(j=0;j<n;j++)
            cout<<dp[i][j]<<" ";
        cout<<"\n";
    }*/
    bool flag=false;
    for(k=0;k<n;k++)
    {
        if(dp[k][k]>1)
            flag=true;
    }
    char ch[60];
    cin.getline(ch,60);
    if(flag)
        cout<<"Case "<<q<<": Yes\n";
    else
        cout<<"Case "<<q<<": No\n";
    q++;
    cin>>n;
}
    return 0;
}
